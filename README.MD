# WaiterApp v2

Sistema completo de gest√£o de restaurante com aplica√ß√£o web, mobile e API robusta para controle de pedidos, usu√°rios e card√°pio.

## Tecnologias

### Backend
- **Fastify** - Framework web r√°pido e eficiente
- **Prisma** - ORM moderno com type-safety
- **Zod** - Valida√ß√£o de schemas e types
- **PostgreSQL** - Banco de dados relacional
- **JWT** - Autentica√ß√£o e autoriza√ß√£o
- **AWS S3** - Upload de imagens com presigned URLs

### Frontend Web
- **React** - Biblioteca de interface de usu√°rio
- **TanStack Router** - Roteamento type-safe
- **Tailwind CSS** - Framework CSS utility-first
- **React Query** - Gerenciamento de estado servidor

### Mobile
- **React Native** - Framework mobile multiplataforma
- **Expo** - Plataforma de desenvolvimento
- **StyleSheet** - Estiliza√ß√£o nativa

## Funcionalidades

### Autentica√ß√£o e Usu√°rios
- Login com email e senha
- Registro de gar√ßons (apenas admins)
- Edi√ß√£o e exclus√£o de usu√°rios
- Recupera√ß√£o de senha via email
- Refresh token autom√°tico
- Rate limiting para tentativas de login
- Criptografia de senhas com bcrypt

### Gest√£o do Card√°pio
- Cadastro de categorias com emoji
- Cadastro de ingredientes
- Cadastro de produtos com:
  - Nome, descri√ß√£o e pre√ßo
  - Categoria associada
  - Ingredientes selecionados
  - Upload de imagem

### Pedidos
- Cria√ß√£o de pedidos por mesa
- Status de pedido: Aguardando, Em Produ√ß√£o, Finalizado
- Controle de quantidade

### Upload de Arquivos
- Presigned URLs para upload direto no S3
- Processamento via AWS Lambda
- Otimiza√ß√£o autom√°tica de imagens

## Estrutura do Banco

### ERD (Entity Relationship Diagram)

```mermaid
erDiagram
    User ||--o{ Order : creates
    Category ||--o{ Product : contains
    Product }o--o{ Ingredient : has
    Order }o--|| Product : includes

    User {
        string id PK
        string name
        string email UK
        string password
        UserType type
        datetime created_at
    }

    Category {
        string id PK
        string name UK
        string emoji
        datetime createdAt
    }

    Ingredient {
        string id PK
        string name UK
        string emoji
        datetime createdAt
    }

    Product {
        string id PK
        string name
        string description
        decimal price
        string imageUrl
        string categoryId FK
    }

    Order {
        string id PK
        int table
        OrderStatus status
        int quantity
    }

    UserType {
        WAITER
        ADMIN
    }

    OrderStatus {
        WAITING
        IN_PRODUCTION
        DONE
    }
```

## Regras de Neg√≥cio

### Usu√°rios
- Senhas criptografadas obrigatoriamente
- Apenas admins podem gerenciar gar√ßons
- Rate limiting: m√°ximo 5 tentativas de login por minuto
- Bloqueio tempor√°rio ap√≥s m√∫ltiplas tentativas incorretas
- Recovery de senha via email com token tempor√°rio

### Produtos
- Categorias obrigat√≥rias para produtos
- Pre√ßos com precis√£o decimal (10,2)
- Upload de imagens obrigat√≥rio
- Ingredientes opcionais por produto

### Pedidos
- Mesa obrigat√≥ria para identifica√ß√£o
- Status padr√£o: "Em Produ√ß√£o"
- Quantidade m√≠nima: 1 item

## API Endpoints

### Autentica√ß√£o
```
POST /auth/login       # Login de usu√°rio
POST /auth/refresh     # Renovar token
POST /auth/forgot      # Solicitar reset de senha
POST /auth/reset       # Resetar senha
```

### Usu√°rios (Admin apenas)
```
POST /users            # Criar gar√ßom
GET /users             # Listar usu√°rios
PUT /users/:id         # Editar usu√°rio
DELETE /users/:id      # Deletar usu√°rio
```

### Card√°pio
```
GET /categories        # Listar categorias
POST /categories       # Criar categoria
PUT /categories/:id    # Editar categoria
DELETE /categories/:id # Deletar categoria

GET /ingredients       # Listar ingredientes
POST /ingredients      # Criar ingrediente
PUT /ingredients/:id   # Editar ingrediente
DELETE /ingredients/:id # Deletar ingrediente

GET /products          # Listar produtos
POST /products         # Criar produto
PUT /products/:id      # Editar produto
DELETE /products/:id   # Deletar produto
```

### Upload
```
POST /upload/presigned # Gerar URL de upload
```

### Pedidos
```
GET /orders            # Listar pedidos
POST /orders           # Criar pedido
PUT /orders/:id        # Atualizar pedido
DELETE /orders/:id     # Cancelar pedido
```

## Status do Projeto

### ‚úÖ Implementado
- Autentica√ß√£o b√°sica (login/logout)
- CRUD de usu√°rios, categorias, ingredientes e produtos
- Estrutura do banco de dados
- APIs b√°sicas do backend
- Interface web responsiva
- App mobile b√°sico

### üöß Em Desenvolvimento
- Upload de arquivos com presigned URLs
- Sistema de refresh token
- Rate limiting e seguran√ßa
- Recovery de senha
- Sistema de emails
- Funcionalidades avan√ßadas de pedidos

### üìã Pr√≥ximas Funcionalidades
- Dashboard administrativo
- Relat√≥rios de vendas
- Notifica√ß√µes push
- Sistema de mesas
- Integra√ß√£o com impressoras
- Modo offline

## Estrutura de Pastas

```
waiterapp-v2/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ mobile/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
```

## Licen√ßa

Este projeto est√° sob a licen√ßa MIT.